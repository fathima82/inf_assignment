SQL> conn hr/hr
Connected.
SQL> desc employees
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 EMPLOYEE_ID                               NOT NULL NUMBER(6)
 FIRST_NAME                                         VARCHAR2(20)
 LAST_NAME                                 NOT NULL VARCHAR2(25)
 EMAIL                                     NOT NULL VARCHAR2(25)
 PHONE_NUMBER                                       VARCHAR2(20)
 HIRE_DATE                                 NOT NULL DATE
 JOB_ID                                    NOT NULL VARCHAR2(10)
 SALARY                                             NUMBER(8,2)
 COMMISSION_PCT                                     NUMBER(2,2)
 MANAGER_ID                                         NUMBER(6)
 DEPARTMENT_ID                                      NUMBER(4)

SQL> select employee_id, last_name from employees where last_name in any(select last_name from employees where substr(last_name,length(last_name)-1) like '%u') group by department_id;
select employee_id, last_name from employees where last_name in any(select last_name from employees where substr(last_name,length(last_name)-1) like '%u') group by department_id
                                                                *
ERROR at line 1:
ORA-00936: missing expression 


SQL> select employee_id, last_name from employees where last_name any(select last_name from employees where substr(last_name,length(last_name)-1) like '%u') group by department_id;
select employee_id, last_name from employees where last_name any(select last_name from employees where substr(last_name,length(last_name)-1) like '%u') group by department_id
                                                             *
ERROR at line 1:
ORA-00920: invalid relational operator 


SQL> select employee_id, last_name from employees where department_id in(select department_id from employees where substr(last_name,length(last_name)-1) like '%u') group by department_id;
select employee_id, last_name from employees where department_id in(select department_id from employees where substr(last_name,length(last_name)-1) like '%u') group by department_id
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select employee_id, last_name from employees where department_id in(select department_id from employees where substr(last_name,length(last_name)-1) like '%u') ;

no rows selected

SQL> select employee_id, last_name from employees where department_id in(select department_id from employees where last_name like 'u') ;

no rows selected

SQL> select employee_id, last_name from employees where department_id in(select department_id from employees where last_name like '%u') ;

no rows selected

SQL> select employee_id, last_name from employees where department_id in (select department_id from employees where last_name like '%u') ;

no rows selected

SQL> select department_id from employees where last_name like '%u';

no rows selected

SQL> select last_name from employees;

LAST_NAME                                                                       
-------------------------                                                       
Abel                                                                            
Ande                                                                            
Atkinson                                                                        
Austin                                                                          
Baer                                                                            
Baida                                                                           
Banda                                                                           
Bates                                                                           
Bell                                                                            
Bernstein                                                                       
Bissot                                                                          

LAST_NAME                                                                       
-------------------------                                                       
Bloom                                                                           
Bull                                                                            
Cabrio                                                                          
Cambrault                                                                       
Cambrault                                                                       
Chen                                                                            
Chung                                                                           
Colmenares                                                                      
Davies                                                                          
De Haan                                                                         
Dellinger                                                                       

LAST_NAME                                                                       
-------------------------                                                       
Dilly                                                                           
Doran                                                                           
Ernst                                                                           
Errazuriz                                                                       
Everett                                                                         
Faviet                                                                          
Fay                                                                             
Feeney                                                                          
Fleaur                                                                          
Fox                                                                             
Fripp                                                                           

LAST_NAME                                                                       
-------------------------                                                       
Gates                                                                           
Gee                                                                             
Geoni                                                                           
Gietz                                                                           
Grant                                                                           
Grant                                                                           
Greenberg                                                                       
Greene                                                                          
Hall                                                                            
Hartstein                                                                       
Higgins                                                                         

LAST_NAME                                                                       
-------------------------                                                       
Himuro                                                                          
Hunold                                                                          
Hutton                                                                          
Johnson                                                                         
Jones                                                                           
Kaufling                                                                        
Khoo                                                                            
King                                                                            
King                                                                            
Kochhar                                                                         
Kumar                                                                           

LAST_NAME                                                                       
-------------------------                                                       
Ladwig                                                                          
Landry                                                                          
Lee                                                                             
Livingston                                                                      
Lorentz                                                                         
Mallin                                                                          
Markle                                                                          
Marlow                                                                          
Marvins                                                                         
Matos                                                                           
Mavris                                                                          

LAST_NAME                                                                       
-------------------------                                                       
McCain                                                                          
McEwen                                                                          
Mikkilineni                                                                     
Mourgos                                                                         
Nayer                                                                           
OConnell                                                                        
Olsen                                                                           
Olson                                                                           
Ozer                                                                            
Partners                                                                        
Pataballa                                                                       

LAST_NAME                                                                       
-------------------------                                                       
Patel                                                                           
Perkins                                                                         
Philtanker                                                                      
Popp                                                                            
Rajs                                                                            
Raphaely                                                                        
Rogers                                                                          
Russell                                                                         
Sarchand                                                                        
Sciarra                                                                         
Seo                                                                             

LAST_NAME                                                                       
-------------------------                                                       
Sewall                                                                          
Smith                                                                           
Smith                                                                           
Stiles                                                                          
Sullivan                                                                        
Sully                                                                           
Taylor                                                                          
Taylor                                                                          
Tobias                                                                          
Tucker                                                                          
Tuvault                                                                         

LAST_NAME                                                                       
-------------------------                                                       
Urman                                                                           
Vargas                                                                          
Vishney                                                                         
Vollman                                                                         
Walsh                                                                           
Weiss                                                                           
Whalen                                                                          
Zlotkey                                                                         

107 rows selected.

SQL> conn scott/tiger
Connected.
SQL> select* from tab;

TNAME                          TABTYPE  CLUSTERID                               
------------------------------ ------- ----------                               
BONUS                          TABLE                                            
DEPT                           TABLE                                            
EMP                            TABLE                                            
SALGRADE                       TABLE                                            

SQL> select* from emp;

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM      
---------- ---------- --------- ---------- --------- ---------- ----------      
    DEPTNO                                                                      
----------                                                                      
      7369 SMITH      CLERK           7902 17-DEC-80        800                 
        20                                                                      
                                                                                
      7499 ALLEN      SALESMAN        7698 20-FEB-81       1600        300      
        30                                                                      
                                                                                
      7521 WARD       SALESMAN        7698 22-FEB-81       1250        500      
        30                                                                      
                                                                                

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM      
---------- ---------- --------- ---------- --------- ---------- ----------      
    DEPTNO                                                                      
----------                                                                      
      7566 JONES      MANAGER         7839 02-APR-81       2975                 
        20                                                                      
                                                                                
      7654 MARTIN     SALESMAN        7698 28-SEP-81       1250       1400      
        30                                                                      
                                                                                
      7698 BLAKE      MANAGER         7839 01-MAY-81       2850                 
        30                                                                      
                                                                                

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM      
---------- ---------- --------- ---------- --------- ---------- ----------      
    DEPTNO                                                                      
----------                                                                      
      7782 CLARK      MANAGER         7839 09-JUN-81       2450                 
        10                                                                      
                                                                                
      7788 SCOTT      ANALYST         7566 19-APR-87       3000                 
        20                                                                      
                                                                                
      7839 KING       PRESIDENT            17-NOV-81       5000                 
        10                                                                      
                                                                                

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM      
---------- ---------- --------- ---------- --------- ---------- ----------      
    DEPTNO                                                                      
----------                                                                      
      7844 TURNER     SALESMAN        7698 08-SEP-81       1500          0      
        30                                                                      
                                                                                
      7876 ADAMS      CLERK           7788 23-MAY-87       1100                 
        20                                                                      
                                                                                
      7900 JAMES      CLERK           7698 03-DEC-81        950                 
        30                                                                      
                                                                                

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM      
---------- ---------- --------- ---------- --------- ---------- ----------      
    DEPTNO                                                                      
----------                                                                      
      7902 FORD       ANALYST         7566 03-DEC-81       3000                 
        20                                                                      
                                                                                
      7934 MILLER     CLERK           7782 23-JAN-82       1300                 
        10                                                                      
                                                                                

14 rows selected.

SQL> select empno,ename from emp where deptno in (select deptno from emp where ename like '%u') ;

no rows selected

SQL> conn hr/hr
Connected.
SQL> select employee_id, last_name from employees where department_id in (select department_id from employees where last_name like '%u') ;

no rows selected

SQL> select employee_id, last_name from employees where department_id in (select department_id from employees where last_name like '%k') ;

no rows selected

SQL> select employee_id, last_name from employees where department_id in (select department_id from employees where last_name like '%l') ;

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        179 Johnson                                                             
        177 Livingston                                                          
        176 Taylor                                                              
        175 Hutton                                                              
        174 Abel                                                                
        173 Kumar                                                               
        172 Bates                                                               
        171 Smith                                                               
        170 Fox                                                                 
        169 Bloom                                                               
        168 Ozer                                                                

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        167 Banda                                                               
        166 Ande                                                                
        165 Lee                                                                 
        164 Marvins                                                             
        163 Greene                                                              
        162 Vishney                                                             
        161 Sewall                                                              
        160 Doran                                                               
        159 Smith                                                               
        158 McEwen                                                              
        157 Sully                                                               

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        156 King                                                                
        155 Tuvault                                                             
        154 Cambrault                                                           
        153 Olsen                                                               
        152 Hall                                                                
        151 Bernstein                                                           
        150 Tucker                                                              
        149 Zlotkey                                                             
        148 Cambrault                                                           
        147 Errazuriz                                                           
        146 Partners                                                            

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        145 Russell                                                             
        199 Grant                                                               
        198 OConnell                                                            
        197 Feeney                                                              
        196 Walsh                                                               
        195 Jones                                                               
        194 McCain                                                              
        193 Everett                                                             
        192 Bell                                                                
        191 Perkins                                                             
        190 Gates                                                               

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        189 Dilly                                                               
        188 Chung                                                               
        187 Cabrio                                                              
        186 Dellinger                                                           
        185 Bull                                                                
        184 Sarchand                                                            
        183 Geoni                                                               
        182 Sullivan                                                            
        181 Fleaur                                                              
        180 Taylor                                                              
        144 Vargas                                                              

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        143 Matos                                                               
        142 Davies                                                              
        141 Rajs                                                                
        140 Patel                                                               
        139 Seo                                                                 
        138 Stiles                                                              
        137 Ladwig                                                              
        136 Philtanker                                                          
        135 Gee                                                                 
        134 Rogers                                                              
        133 Mallin                                                              

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        132 Olson                                                               
        131 Marlow                                                              
        130 Atkinson                                                            
        129 Bissot                                                              
        128 Markle                                                              
        127 Landry                                                              
        126 Mikkilineni                                                         
        125 Nayer                                                               
        124 Mourgos                                                             
        123 Vollman                                                             
        122 Kaufling                                                            

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        121 Fripp                                                               
        120 Weiss                                                               

79 rows selected.

SQL> select last_name,department_no,job_id from employees where location_id=1700;
select last_name,department_no,job_id from employees where location_id=1700
                                                           *
ERROR at line 1:
ORA-00904: "LOCATION_ID": invalid identifier 


SQL> select last_name,department_no,job_id from employees where department_id in(select * from departments where location_id=1700);
select last_name,department_no,job_id from employees where department_id in(select * from departments where location_id=1700)
                 *
ERROR at line 1:
ORA-00904: "DEPARTMENT_NO": invalid identifier 


SQL> select last_name,department_id,job_id from employees where department_id in(select * from departments where location_id=1700);
select last_name,department_id,job_id from employees where department_id in(select * from departments where location_id=1700)
                                                                            *
ERROR at line 1:
ORA-00913: too many values 


SQL> select last_name,department_id,job_id from employees where department_id in(select department_id from departments where location_id=1700);

LAST_NAME                 DEPARTMENT_ID JOB_ID                                  
------------------------- ------------- ----------                              
King                                 90 AD_PRES                                 
Kochhar                              90 AD_VP                                   
De Haan                              90 AD_VP                                   
Greenberg                           100 FI_MGR                                  
Faviet                              100 FI_ACCOUNT                              
Chen                                100 FI_ACCOUNT                              
Sciarra                             100 FI_ACCOUNT                              
Urman                               100 FI_ACCOUNT                              
Popp                                100 FI_ACCOUNT                              
Raphaely                             30 PU_MAN                                  
Khoo                                 30 PU_CLERK                                

LAST_NAME                 DEPARTMENT_ID JOB_ID                                  
------------------------- ------------- ----------                              
Baida                                30 PU_CLERK                                
Tobias                               30 PU_CLERK                                
Himuro                               30 PU_CLERK                                
Colmenares                           30 PU_CLERK                                
Whalen                               10 AD_ASST                                 
Higgins                             110 AC_MGR                                  
Gietz                               110 AC_ACCOUNT                              

18 rows selected.

SQL> desc employees;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 EMPLOYEE_ID                               NOT NULL NUMBER(6)
 FIRST_NAME                                         VARCHAR2(20)
 LAST_NAME                                 NOT NULL VARCHAR2(25)
 EMAIL                                     NOT NULL VARCHAR2(25)
 PHONE_NUMBER                                       VARCHAR2(20)
 HIRE_DATE                                 NOT NULL DATE
 JOB_ID                                    NOT NULL VARCHAR2(10)
 SALARY                                             NUMBER(8,2)
 COMMISSION_PCT                                     NUMBER(2,2)
 MANAGER_ID                                         NUMBER(6)
 DEPARTMENT_ID                                      NUMBER(4)

SQL> select last_name,salary from employees where manager_id in(select employee_id from employees where upper(last_name)='KING');

LAST_NAME                     SALARY                                            
------------------------- ----------                                            
Kochhar                        17000                                            
De Haan                        17000                                            
Raphaely                       11000                                            
Weiss                           8000                                            
Fripp                           8200                                            
Kaufling                        7900                                            
Vollman                         6500                                            
Mourgos                         5800                                            
Russell                        14000                                            
Partners                       13500                                            
Errazuriz                      12000                                            

LAST_NAME                     SALARY                                            
------------------------- ----------                                            
Cambrault                      11000                                            
Zlotkey                        10500                                            
Hartstein                      13000                                            

14 rows selected.

SQL> select last_name,salary,manager_id from employees where manager_id in(select employee_id from employees where upper(last_name)='KING');

LAST_NAME                     SALARY MANAGER_ID                                 
------------------------- ---------- ----------                                 
Kochhar                        17000        100                                 
De Haan                        17000        100                                 
Raphaely                       11000        100                                 
Weiss                           8000        100                                 
Fripp                           8200        100                                 
Kaufling                        7900        100                                 
Vollman                         6500        100                                 
Mourgos                         5800        100                                 
Russell                        14000        100                                 
Partners                       13500        100                                 
Errazuriz                      12000        100                                 

LAST_NAME                     SALARY MANAGER_ID                                 
------------------------- ---------- ----------                                 
Cambrault                      11000        100                                 
Zlotkey                        10500        100                                 
Hartstein                      13000        100                                 

14 rows selected.

SQL> select department_id,last_name,job_id from employees where job_id like 'AD%';

DEPARTMENT_ID LAST_NAME                 JOB_ID                                  
------------- ------------------------- ----------                              
           10 Whalen                    AD_ASST                                 
           90 King                      AD_PRES                                 
           90 Kochhar                   AD_VP                                   
           90 De Haan                   AD_VP                                   

SQL> DESC departments;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 DEPARTMENT_ID                             NOT NULL NUMBER(4)
 DEPARTMENT_NAME                           NOT NULL VARCHAR2(30)
 MANAGER_ID                                         NUMBER(6)
 LOCATION_ID                                        NUMBER(4)

SQL> DESC employees;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 EMPLOYEE_ID                               NOT NULL NUMBER(6)
 FIRST_NAME                                         VARCHAR2(20)
 LAST_NAME                                 NOT NULL VARCHAR2(25)
 EMAIL                                     NOT NULL VARCHAR2(25)
 PHONE_NUMBER                                       VARCHAR2(20)
 HIRE_DATE                                 NOT NULL DATE
 JOB_ID                                    NOT NULL VARCHAR2(10)
 SALARY                                             NUMBER(8,2)
 COMMISSION_PCT                                     NUMBER(2,2)
 MANAGER_ID                                         NUMBER(6)
 DEPARTMENT_ID                                      NUMBER(4)

SQL> select department_id,last_name,job_id from employees where (select department_name  from departments where lower(department_name)='executive');
select department_id,last_name,job_id from employees where (select department_name  from departments where lower(department_name)='executive')
                                                                                                                                             *
ERROR at line 1:
ORA-00936: missing expression 


SQL> select department_id,last_name,job_id from employees where (select department_name  from departments where lower(department_name='executive');
select department_id,last_name,job_id from employees where (select department_name  from departments where lower(department_name='executive')
                                                            *
ERROR at line 1:
ORA-00936: missing expression 


SQL> select department_id,last_name,job_id from employees where department_id =(select department_id  from departments where lower(department_name)='executive');

DEPARTMENT_ID LAST_NAME                 JOB_ID                                  
------------- ------------------------- ----------                              
           90 King                      AD_PRES                                 
           90 Kochhar                   AD_VP                                   
           90 De Haan                   AD_VP                                   

SQL> select * from employees where salary > all(select salary from employees where department_id=60);

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
        157 Patrick              Sully                                          
PSULLY                    011.44.1345.929268   04-MAR-04 SA_REP           9500  
           .35        146            80                                         
                                                                                
        163 Danielle             Greene                                         
DGREENE                   011.44.1346.229268   19-MAR-07 SA_REP           9500  
           .15        147            80                                         

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
                                                                                
        151 David                Bernstein                                      
DBERNSTE                  011.44.1344.345268   24-MAR-05 SA_REP           9500  
           .25        145            80                                         
                                                                                
        170 Tayler               Fox                                            
TFOX                      011.44.1343.729268   24-JAN-06 SA_REP           9600  

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
            .2        148            80                                         
                                                                                
        204 Hermann              Baer                                           
HBAER                     515.123.8888         07-JUN-02 PR_REP          10000  
                      101            70                                         
                                                                                
        169 Harrison             Bloom                                          

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
HBLOOM                    011.44.1343.829268   23-MAR-06 SA_REP          10000  
            .2        148            80                                         
                                                                                
        156 Janette              King                                           
JKING                     011.44.1345.429268   30-JAN-04 SA_REP          10000  
           .35        146            80                                         
                                                                                

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
        150 Peter                Tucker                                         
PTUCKER                   011.44.1344.129268   30-JAN-05 SA_REP          10000  
            .3        145            80                                         
                                                                                
        162 Clara                Vishney                                        
CVISHNEY                  011.44.1346.129268   11-NOV-05 SA_REP          10500  
           .25        147            80                                         

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
                                                                                
        149 Eleni                Zlotkey                                        
EZLOTKEY                  011.44.1344.429018   29-JAN-08 SA_MAN          10500  
            .2        100            80                                         
                                                                                
        148 Gerald               Cambrault                                      
GCAMBRAU                  011.44.1344.619268   15-OCT-07 SA_MAN          11000  

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
            .3        100            80                                         
                                                                                
        114 Den                  Raphaely                                       
DRAPHEAL                  515.127.4561         07-DEC-02 PU_MAN          11000  
                      100            30                                         
                                                                                
        174 Ellen                Abel                                           

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
EABEL                     011.44.1644.429267   11-MAY-04 SA_REP          11000  
            .3        149            80                                         
                                                                                
        168 Lisa                 Ozer                                           
LOZER                     011.44.1343.929268   11-MAR-05 SA_REP          11500  
           .25        148            80                                         
                                                                                

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
        147 Alberto              Errazuriz                                      
AERRAZUR                  011.44.1344.429278   10-MAR-05 SA_MAN          12000  
            .3        100            80                                         
                                                                                
        205 Shelley              Higgins                                        
SHIGGINS                  515.123.8080         07-JUN-02 AC_MGR          12008  
                      101           110                                         

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
                                                                                
        108 Nancy                Greenberg                                      
NGREENBE                  515.124.4569         17-AUG-02 FI_MGR          12008  
                      101           100                                         
                                                                                
        201 Michael              Hartstein                                      
MHARTSTE                  515.123.5555         17-FEB-04 MK_MAN          13000  

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
                      100            20                                         
                                                                                
        146 Karen                Partners                                       
KPARTNER                  011.44.1344.467268   05-JAN-05 SA_MAN          13500  
            .3        100            80                                         
                                                                                
        145 John                 Russell                                        

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
JRUSSEL                   011.44.1344.429268   01-OCT-04 SA_MAN          14000  
            .4        100            80                                         
                                                                                
        102 Lex                  De Haan                                        
LDEHAAN                   515.123.4569         13-JAN-01 AD_VP           17000  
                      100            90                                         
                                                                                

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
        101 Neena                Kochhar                                        
NKOCHHAR                  515.123.4568         21-SEP-05 AD_VP           17000  
                      100            90                                         
                                                                                
        100 Steven               King                                           
SKING                     515.123.4567         17-JUN-03 AD_PRES         24000  
                                     90                                         

EMPLOYEE_ID FIRST_NAME           LAST_NAME                                      
----------- -------------------- -------------------------                      
EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY  
------------------------- -------------------- --------- ---------- ----------  
COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                         
-------------- ---------- -------------                                         
                                                                                

23 rows selected.

SQL> select employee_id,last_name,salary from employees where salary > (select avg(salary) from employees where last_name like '%u' group by department_id);

no rows selected

SQL> select employee_id,last_name,salary from employees where salary > (select avg(salary) from employees where department_id=(select department_id from employees where last_name like'%u');
select employee_id,last_name,salary from employees where salary > (select avg(salary) from employees where department_id=(select department_id from employees where last_name like'%u')
                                                                   *
ERROR at line 1:
ORA-00921: unexpected end of SQL command 


SQL> select employee_id,last_name,salary from employees where salary > (select avg(salary) from employees where department_id=(select department_id from employees where last_name like'%u'));

no rows selected

SQL> select employee_id,last_name,salary from employees  where department_id in (select department_id from employees where last_name like'%u') having salary >avg(salary);
select employee_id,last_name,salary from employees  where department_id in (select department_id from employees where last_name like'%u') having salary >avg(salary)
                                                                                                                                                 *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select employee_id,last_name,salary from employees  where department_id in (select department_id from employees where last_name like'%u') having salary >(select avg(salary) from employees);
select employee_id,last_name,salary from employees  where department_id in (select department_id from employees where last_name like'%u') having salary >(select avg(salary) from employees)
                                                                                                                                                 *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> select employee_id,last_name,salary from employees  where department_id in (select department_id from employees where last_name like'%u') and salary >(select avg(salary) from employees);

no rows selected

SQL> select employee_id,last_name,salary from employees  where department_id in (select department_id from employees where last_name like'%u%') and salary >(select avg(salary) from employees);

EMPLOYEE_ID LAST_NAME                     SALARY                                
----------- ------------------------- ----------                                
        103 Hunold                          9000                                
        123 Vollman                         6500                                
        122 Kaufling                        7900                                
        121 Fripp                           8200                                
        120 Weiss                           8000                                
        177 Livingston                      8400                                
        176 Taylor                          8600                                
        175 Hutton                          8800                                
        174 Abel                           11000                                
        172 Bates                           7300                                
        171 Smith                           7400                                

EMPLOYEE_ID LAST_NAME                     SALARY                                
----------- ------------------------- ----------                                
        170 Fox                             9600                                
        169 Bloom                          10000                                
        168 Ozer                           11500                                
        165 Lee                             6800                                
        164 Marvins                         7200                                
        163 Greene                          9500                                
        162 Vishney                        10500                                
        161 Sewall                          7000                                
        160 Doran                           7500                                
        159 Smith                           8000                                
        158 McEwen                          9000                                

EMPLOYEE_ID LAST_NAME                     SALARY                                
----------- ------------------------- ----------                                
        157 Sully                           9500                                
        156 King                           10000                                
        155 Tuvault                         7000                                
        154 Cambrault                       7500                                
        153 Olsen                           8000                                
        152 Hall                            9000                                
        151 Bernstein                       9500                                
        150 Tucker                         10000                                
        149 Zlotkey                        10500                                
        148 Cambrault                      11000                                
        147 Errazuriz                      12000                                

EMPLOYEE_ID LAST_NAME                     SALARY                                
----------- ------------------------- ----------                                
        146 Partners                       13500                                
        145 Russell                        14000                                
        114 Raphaely                       11000                                

36 rows selected.

SQL> spool off;
